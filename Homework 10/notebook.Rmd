---
title: "Homework 10"
author: "Brayan Duran Medina"
output: html_document
---

```{r, message=FALSE, warning=FALSE, echo=FALSE, error = FALSE, results='hide'}
library(leaflet)
library(dplyr)
library(readr)
library(htmltools)
library(sf)

world <- st_read("data/world.shp")

data <- read_csv("data/icpc-full.csv")

data$Host[data$Host == "Czechia"] <- "Czech Rep."
data$Host[data$Country == "Czechia"] <- "Czech Rep."

host_counts <- data %>%
  select(Year, Host) %>%
  distinct() %>%
  group_by(Host) %>%
  summarise(Count = n()) %>%
  ungroup()

world <- world %>%
  left_join(host_counts, by = c("name" = "Host"))

world$Count[is.na(world$Count)] <- 0

pal <- colorNumeric("YlOrRd", domain = world$Count)

total_hosted <- sum(world$Count)
```

## International Collegiate Programming Contest (ICPC) Heatmap of Host Countries

```{r, message=FALSE, warning=FALSE, echo=FALSE, error = FALSE, }
map <- leaflet(data = world) %>%
  addTiles() %>%
  addPolygons(
    fillColor = ~pal(Count),
    weight = 1,
    opacity = 1,
    color = "white",
    dashArray = "3",
    fillOpacity = 0.7,
    highlight = highlightOptions(
      weight = 3,
      color = "#666",
      dashArray = "",
      fillOpacity = 0.7,
      bringToFront = TRUE
    ),
    label = ~paste(name, ": ", Count, " times hosted"),
    labelOptions = labelOptions(
      style = list("font-weight" = "normal", padding = "3px 8px"),
      textsize = "15px",
      direction = "auto"
    )
  ) %>%
  addLegend(
    pal = pal,
    values = ~Count,
    opacity = 0.7,
    title = "Times Hosted",
    position = "bottomright"
  )

map
```