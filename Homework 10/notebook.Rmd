---
title: "Homework 10"
author: "Brayan Duran Medina"
output: html_document
---

ICPC data

```{r}
library(leaflet)
library(dplyr)
library(readr)
library(sf)

world <- st_read("data/world.shp")

data <- read_csv("data/icpc-full.csv")

host_counts <- data %>%
  group_by(Host) %>%
  summarise(Count = n()) %>%
  ungroup()

print(world)

world <- world %>%
  left_join(host_counts, by = c("name_long" = "Host"))

world$Count[is.na(world$Count)] <- 0

pal <- colorNumeric("YlOrRd", domain = world$Count)

leaflet(data = world) %>%
  addTiles() %>%
  addPolygons(
    fillColor = ~pal(Count),
    weight = 1,
    opacity = 1,
    color = "white",
    dashArray = "3",
    fillOpacity = 0.7,
    highlight = highlightOptions(
      weight = 3,
      color = "#666",
      dashArray = "",
      fillOpacity = 0.7,
      bringToFront = TRUE
    ),
    label = ~paste(name_long, ": ", Count, " times hosted"),
    labelOptions = labelOptions(
      style = list("font-weight" = "normal", padding = "3px 8px"),
      textsize = "15px",
      direction = "auto"
    )
  ) %>%
  addLegend(
    pal = pal,
    values = ~Count,
    opacity = 0.7,
    title = "Times Hosted",
    position = "bottomright"
  )
```