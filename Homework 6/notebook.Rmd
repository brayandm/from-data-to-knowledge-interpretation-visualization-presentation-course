---
title: "Homework 6"
author: "Brayan Duran Medina"
output: html_document
---

# Consolidation exercise 1 ########

1. Read ESP_adm2 into R. 
2. Move the Canary Island to a convenient place close to peninsular Spain.Hint: c(5,7.5) 
3. Save your new sf object as a shapefile.
3. Create a discrete map of Spain filling polygons belonging to same region 
(Hint: NAME_1) with the same color. Also Add labels with the name of the provinces. 
Your map should look similar to the one below. (NOTE: the instructor is a lazy 
guy and he used the default color palette from ggplot. Don't be as lazy as the 
instructor,please.)

```{r}
library(sf)
library(tidyverse)
library(ggrepel)
library(RColorBrewer)

esp <- read_sf(dsn = ".", "ESP_adm2")

esp_simply <- st_simplify(esp, preserveTopology = TRUE, dTolerance = 1000)

canarias <- esp_simply |> filter(NAME_1 == "Islas Canarias")

rest_of_spain <- esp_simply |> filter(NAME_1 != "Islas Canarias")

canarias_g <- st_geometry(canarias)

canarias_g <- canarias_g + c(5, 7.5)

st_crs(canarias_g) <- st_crs(esp)

canarias <- st_set_geometry(canarias, canarias_g)
esp_simply <- bind_rows(canarias, rest_of_spain)

base_palette <- brewer.pal(n = 12, name = "Set3")
color_palette <- colorRampPalette(base_palette)(length(unique(esp_simply$NAME_1)))

plot <- ggplot(data = esp_simply) +
  geom_sf(aes(fill = NAME_1), color = "white", lwd = 0.2) +
  scale_fill_manual(values = color_palette) +
  geom_text_repel(data = esp_simply, aes(label = NAME_2, geometry = geometry),
                  stat = "sf_coordinates", size = 3, min.segment.length = 0) +
  theme_minimal() +
  theme(legend.position = "none", 
        axis.title = element_blank(), 
        axis.text = element_blank(), 
        axis.ticks = element_blank(),
        panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(),
    panel.background = element_rect(fill = "white", color = NA) 
        )

ggsave("plot1.png", plot, width = 20, height = 20, units = "cm")
```

# Consolidation exercise 2 #######
1. In folder of data you will find the shapefile **BCN_CT** (Barcelona by census tracts). Read it into R under the name **BCN** and plot it. 
2. Answer the following questions: 
  + 2.1 By how many polygons is this shapefile composed?
  + 2.2 Which is the CRS associated to this shapefile? 
  + 2.3 Which is the bounding box (bbox) corresponding to this shapefile? 
3. Create a new sf object with the division by districts of Barcelona. 
4. Create a Multi-Layer map of Barcelona by census tract overlaying the districts boundaries and adding the name of each district on its centroid. Save your final map as an image. 

```{r}
```